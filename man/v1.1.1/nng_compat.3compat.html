---
version: v1.1.1
layout: refman
---
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>nng_compat(3compat)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="manpage toc2 toc-left">
<div id="header">
<h1>nng_compat(3compat) Manual Page</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_synopsis">SYNOPSIS</a></li>
<li><a href="#_description">DESCRIPTION</a>
<ul class="sectlevel2">
<li><a href="#_compiling">Compiling</a></li>
<li><a href="#_functions">Functions</a></li>
<li><a href="#_caveats">Caveats</a></li>
</ul>
</li>
<li><a href="#_see_also">SEE ALSO</a></li>
</ul>
</div>
<h2 id="_name">NAME</h2>
<div class="sectionbody">
<p>nng_compat - compatibility with nanomsg 1.0</p>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_synopsis">SYNOPSIS</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/nn.h&gt;</span><span class="tok-cp"></span>

<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/bus.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/pair.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/pipeline.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/pubsub.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/reqrep.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/survey.h&gt;</span><span class="tok-cp"></span>

<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/inproc.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/ipc.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/tcp.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/ws.h&gt;</span><span class="tok-cp"></span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_description">DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>
The <a href="nng.7.html"><em>nng</em></a> library provides source-level compatibility for
most <em>nanomsg</em> 1.0 applications.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This is intended to facilitate converting legacy applications to
use the <em>nng</em> library.
New applications should use the newer <a href="nng.7.html"><em>nng</em></a> API instead.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Applications making use of this must take care
to link with <a href="libnng.3.html"><em>libnng</em></a> instead of <em>libnn</em>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
While not recommended for long term use, the value returned by
<a href="nng_socket_id.3.html">nng_socket_id()</a> can be used with these functions
just like a value returned by <a href="nn_socket.3compat.html">nn_socket()</a>.
This can be way to facilitate incremental transition to the new API.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some capabilities, protocols, and transports, will not be accessible
using this API, as the compatible API has no provision for expression
of certain concepts introduced in the newer <a href="nng.7.html"><em>nng</em></a> API.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While reasonable efforts have been made to provide for compatibility,
some things may behave differently, and some less common parts of the
<em>nanomsg</em> 1.0 API are not supported at this time, including certain
options and the statistics API.
See the <a href="#_caveats">Caveats</a> section below.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_compiling">Compiling</h3>
<div class="paragraph">
<p>When compiling legacy <em>nanomsg</em> applications, it will generally be
necessary to change the include search path to add the &#8220;compat&#8221; subdirectory
of the directory where headers were installed.
For example, if <em>nng</em> is installed in <code>$prefix</code>, then header files will
normally be located in <code>$prefix/include/nng</code>.
In this case, to build legacy <em>nanomsg</em> apps against <em>nng</em> you would
add <code>$prefix/include/nng/compat</code> to your compiler&#8217;s search path.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can change your source code so that <code>#include</code> statements
referring to <code>&lt;nanomsg&gt;</code> instead refer to <code>&lt;nng/compat/nanomsg&gt;</code>.
For example, instead of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/nn.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nanomsg/reqrep.h&gt;</span><span class="tok-cp"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>you would have this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c"><span></span><span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nng/compat/nanomsg/nn.h&gt;</span><span class="tok-cp"></span>
<span class="tok-cp">#include</span> <span class="tok-cpf">&lt;nng/compat/nanomsg/reqrep.h&gt;</span><span class="tok-cp"></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Legacy applications built using these methods should be linked against <em>libnng</em>
instead of <em>libnn</em>, just like any other <em>nng</em> application.</p>
</div>
</div>
<div class="sect2">
<h3 id="_functions">Functions</h3>
<div class="paragraph">
<p>The following functions are provided:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code><a href="nn_socket.3compat.html">nn_socket()</a></code>
</td>
<td class="hdlist2">
<p>create socket</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_getsockopt.3compat.html">nn_getsockopt()</a></code>
</td>
<td class="hdlist2">
<p>get socket option</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_setsockopt.3compat.html">nn_setsockopt()</a></code>
</td>
<td class="hdlist2">
<p>set socket option</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_bind.3compat.html">nn_bind()</a></code>
</td>
<td class="hdlist2">
<p>accept connections from remote peers</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_connect.3compat.html">nn_connect()</a></code>
</td>
<td class="hdlist2">
<p>connect to remote peer</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_send.3compat.html">nn_send()</a></code>
</td>
<td class="hdlist2">
<p>send data</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_recv.3compat.html">nn_recv()</a></code>
</td>
<td class="hdlist2">
<p>receive data</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_shutdown.3compat.html">nn_shutdown()</a></code>
</td>
<td class="hdlist2">
<p>shut down endpoint</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_close.3compat.html">nn_close()</a></code>
</td>
<td class="hdlist2">
<p>close socket</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_poll.3compat.html">nn_poll()</a></code>
</td>
<td class="hdlist2">
<p>poll sockets</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_device.3compat.html">nn_device()</a></code>
</td>
<td class="hdlist2">
<p>create forwarding device</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_recvmsg.3compat.html">nn_recvmsg()</a></code>
</td>
<td class="hdlist2">
<p>receive message</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_sendmsg.3compat.html">nn_sendmsg()</a></code>
</td>
<td class="hdlist2">
<p>send message</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_cmsg.3compat.html">nn_cmsg()</a></code>
</td>
<td class="hdlist2">
<p>message control data</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_get_statistic.3compat.html">nn_get_statistic()</a></code>
</td>
<td class="hdlist2">
<p>get statistic (stub)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_allocmsg.3compat.html">nn_allocmsg()</a></code>
</td>
<td class="hdlist2">
<p>allocate message</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_reallocmsg.3compat.html">nn_reallocmsg()</a></code>
</td>
<td class="hdlist2">
<p>reallocate message</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_freemsg.3compat.html">nn_freemsg()</a></code>
</td>
<td class="hdlist2">
<p>free message</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_errno.3compat.html">nn_errno()</a></code>
</td>
<td class="hdlist2">
<p>return most recent error</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_strerror.3compat.html">nn_strerror()</a></code>
</td>
<td class="hdlist2">
<p>return message for error</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="nn_term.3compat.html">nn_term()</a></code>
</td>
<td class="hdlist2">
<p>terminate library</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_caveats">Caveats</h3>
<div class="paragraph">
<p>The following caveats apply when using the legacy API with <em>nng</em>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Socket numbers can be quite large.
The legacy <em>libnanomsg</em> attempted to reuse socket numbers, like
file descriptors in UNIX systems.
The <em>nng</em> library avoids this to prevent accidental reuse or
collision after a descriptor is closed.
Consequently, socket numbers can become quite large, and should
probably not be used for array indices.</p>
</li>
<li>
<p>The following options (<code>nn_getsockopt</code>) are unsupported:
<code>NN_SNDPRIO</code>, <code>NN_RCVPRIO</code>, <code>NN_IPV4ONLY</code>.
The priority options may be supported in the future, when
the underlying capability is present in <em>nng</em>.</p>
</li>
<li>
<p>Access to statistics using this legacy API
(<code><a href="nn_get_statistic.3compat.html">nn_get_statistic()</a></code>) is unsupported.</p>
</li>
<li>
<p>Some transports can support longer URLs than legacy <em>libnanomsg</em> can.
It is a good idea to use short pathnames in URLs if interoperability
is a concern.</p>
</li>
<li>
<p>Only absolute paths are supported in <code>ipc://</code> URLs.
For example, <code>ipc:///tmp/mysocket</code> is acceptable, but <code>ipc://mysocket</code> is not.</p>
</li>
<li>
<p>The WebSocket transport in this implementation (<code>ws://</code> URLs)
only supports BINARY frames.</p>
</li>
<li>
<p>Some newer transports are unusable from this mode.
In particular, this legacy API offers no way to configure
TLS or ZeroTier parameters that may be required for use.</p>
</li>
<li>
<p>ABI versioning of the compatibility layer is not supported,
and the <code>NN_VERSION_</code> macros are not present.</p>
</li>
<li>
<p>Runtime symbol information is not implemented.
Specifically, there is no <code>nn_symbol()</code> function yet.
(This may be addressed later if there is a need.)</p>
</li>
<li>
<p>The TCP transport (<code>tcp://</code> URLs) does not support specifying the local
address or interface when binding.  (This could be fixed in the future,
but most likely this will be available only using the new API.)</p>
</li>
<li>
<p>The values of <code>NN_RCVMAXSIZE</code> are constrained.
Specifically, values set larger than 2GB using the new API will be reported
as unlimited (<code>-1</code>) in the new API, and the value <code>0</code> will disable any
enforcement, just like <code>-1</code>.
(There is no practical reason to ever want to limit the receive size to
zero.)</p>
</li>
<li>
<p>This implementation counts buffers in terms of messages rather than bytes.
As a result, the buffer sizes accessed with <code>NN_SNDBUF</code> and <code>NN_RCVBUF</code> are
rounded up to a whole number of kilobytes, then divided by 1024, in order
to approximate buffering assuming 1 KB messages.
Few applications should need to adjust the default values.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">SEE ALSO</h2>
<div class="sectionbody">
<div class="paragraph text-left">
<p><a href="libnng.3.html">libnng(3)</a>,
<a href="nng.7.html">nng(7)</a></p>
</div>
</div>
</div>
</div>
<link rel="stylesheet" href="./pygments-default.css">
</body>
</html>